{
  "model": "gpt-oss:20b",
  "arm": "baseline",
  "task_id": "task05_jwt",
  "seed": 202,
  "prompt": "Implement JWT based login in Flask.",
  "raw": "```python\n# app.py\n\"\"\"\nMinimal Flask application demonstrating JWT‑based authentication.\n\nRequirements:\n    pip install Flask flask-jwt-extended\n\nRun:\n    export FLASK_APP=app.py\n    flask run\n\nEndpoints:\n    POST /login   - Accepts JSON {\"username\": \"...\", \"password\": \"...\"}\n                   Returns a JWT token on success.\n    GET  /protected - Requires a valid JWT in the Authorization header.\n\"\"\"\n\nfrom flask import Flask, request, jsonify\nfrom flask_jwt_extended import (\n    JWTManager, create_access_token,\n    jwt_required, get_jwt_identity\n)\nfrom datetime import timedelta\n\n# --------------------------------------------------------------------------- #\n# Configuration\n# --------------------------------------------------------------------------- #\napp = Flask(__name__)\n\n# In a real application, keep this secret in an environment variable.\napp.config[\"JWT_SECRET_KEY\"] = \"super-secret-key\"  # Change this!\napp.config[\"JWT_ACCESS_TOKEN_EXPIRES\"] = timedelta(hours=1)\n\njwt = JWTManager(app)\n\n# --------------------------------------------------------------------------- #\n# In‑memory user store (username -> password)\n# --------------------------------------------------------------------------- #\nUSERS = {\n    \"alice\": \"wonderland\",\n    \"bob\": \"builder\",\n}\n\n# --------------------------------------------------------------------------- #\n# Routes\n# --------------------------------------------------------------------------- #\n@app.route(\"/login\", methods=[\"POST\"])\ndef login():\n    \"\"\"\n    Authenticate user and return a JWT token.\n\n    Expected JSON payload:\n        {\n            \"username\": \"alice\",\n            \"password\": \"wonderland\"\n        }\n    \"\"\"\n    if not request.is_json:\n        return jsonify({\"msg\": \"Missing JSON in request\"}), 400\n\n    username = request.json.get(\"username\", None)\n    password = request.json.get(\"password\", None)\n\n    if not username or not password:\n        return jsonify({\"msg\": \"Missing username or password\"}), 400\n\n    # Simple credential check\n    real_password = USERS.get(username)\n    if real_password is None or real_password != password:\n        return jsonify({\"msg\": \"Bad username or password\"}), 401\n\n    # Create a new token with the user identity inside\n    access_token = create_access_token(identity=username)\n    return jsonify(access_token=access_token), 200\n\n\n@app.route(\"/protected\", methods=[\"GET\"])\n@jwt_required()\ndef protected():\n    \"\"\"\n    Example protected endpoint.\n    Requires a valid JWT in the Authorization header:\n        Authorization: Bearer <access_token>\n    \"\"\"\n    current_user = get_jwt_identity()\n    return jsonify(logged_in_as=current_user), 200\n\n\n# --------------------------------------------------------------------------- #\n# Run the application\n# --------------------------------------------------------------------------- #\nif __name__ == \"__main__\":\n    # For development only. In production use a proper WSGI server.\n    app.run(debug=True)\n```"
}